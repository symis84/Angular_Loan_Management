"use strict";var app=angular.module("webApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap"]);app.factory("Model",["$http",function(a){var b=function(){return a.get("current-loans.json")};return{loadLoansAvailable:function(){return b()}}}]),app.filter("millToDate",function(){return function(a){var b,c,d=86400,e=Math.floor(a/d);e>31&&(c=Math.floor(e/31),e-=31*c,b=c>9?"Months":"Month");var f;return f=e>9?"Days":"Day",null!=c?c+" "+b+" "+e+" "+f:e+" "+f}}),app.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/loan",{controller:"loanCtrl",templateUrl:"views/loan.html"}).otherwise({redirectTo:"/"})}]),angular.module("webApp").controller("ModalInstanceCtrl",["$uibModalInstance","items",function(a,b){var c=this;c.items=b,c.investNow=function(b){var d=parseFloat(c.items.available.replace(",",""));!isNaN(b)&&b<=d&&a.close({id:c.items.id,val:b})},c.cancel=function(){a.dismiss("cancel")}}]),angular.module("webApp").controller("MainCtrl",["$scope","$routeParams",function(a,b){a.msg="Welcome page"}]),angular.module("webApp").controller("loanCtrl",["$scope","$rootScope","Model","$uibModal",function(a,b,c,d){a.msg="Current Loans",a.totalAmountAvailable=0,c.loadLoansAvailable().success(function(b,c,d){a.loansAvailable=b.loans,a.loansAvailable.forEach(function(b,c){var d=parseFloat(b.available.replace(",",""));a.totalAmountAvailable=a.totalAmountAvailable+d}),a.totalAmountAvailable=a.totalAmountAvailable.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}).error(function(a,b,c,d){}),a.openModal=function(b){var c=d.open({animation:!0,templateUrl:"views/myModalContent.html",controller:"ModalInstanceCtrl",controllerAs:"$ctrl",size:"sm",resolve:{items:function(){return a.loansAvailable[b]}}});c.result.then(function(b){a.calculateTotalAmountAvailable(b)},function(){console.log("Modal dismissed at: "+new Date)})},a.calculateTotalAmountAvailable=function(b){a.loansAvailable.forEach(function(c,d){if(c.id==b.id){var e=parseFloat(c.available.replace(",",""));c.available=(e-b.val).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),a.totalAmountAvailable=a.totalAmountAvailable.replace(",","")-b.val,c.invested=!0}}),a.totalAmountAvailable=a.totalAmountAvailable.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]);